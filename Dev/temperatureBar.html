<html>

<head>
	<meta name="viewport" content= "width=device-width, user-scalable=no">
    <link _href="../Css/üñ•Ô∏è.css" rel="stylesheet" type="text/css">
	<script src="../Scripts/jquery-3.5.0.min.js"></script>
	
<style></style>

<script>


$(document).ready(function() {
	temperatureBar(15.5);
});


function temperatureBar(t) {
	try {
	
	var canvas = $("#temperature")
		//.attr("id","temperatureBar")
		//.attr("class","popup")
		//.attr("style","")
		.html("<canvas id='temperatureBar' width='100%' height='100%' _style='border:1px solid #eee;'></canvas>")
		//.appendTo("#temperature")
		.css({
	        //'position' : 'absolute',
	        //'width' : '90',
	        //'height' : '500'
	        //'width' : function() { return $("#forcast").outerWidth(); },
	        //'height' : function() { return $("#forcast").innerHeight(); }
			
	    });
	// bug üêõ
	$("#temperatureBar")
		.attr('width',canvas.width())
		.attr('height',canvas.height());

	var ctx = document.getElementById("temperatureBar")
		.getContext("2d");
//alert (canvas.height());
	var width = canvas.width(), height = canvas.height(), 
		margin = 5, stops = GredientConverter.maxTemperature/10, 
		section = (height - margin*2)/10; 
	
//alert(stops +' ' + section +' ' + height);
	for (var i=0; i < 10; i++) {
		var grd = ctx.createLinearGradient(0, margin + section*i, 0, margin + section*(i+1) );
		for (var j=0; j <= stops; j++) {
			grd.addColorStop(j/stops, GredientConverter.toTemperature((10-i)*stops-j-1));
		} 
		ctx.fillStyle = grd; 

//$("#log").html(' üôè '+margin+'_'+(margin+(section*i))+'_'+ (width-(margin*2))+'_'+ section+"<br>"+$("#log").html());
		 
		ctx.fillRect(margin, margin+(section*i), width-(margin*2), section );
//ctx.fillRect(30,30,30,20);

	}
	

	// mark the current temperature 
	t=t<0?0:t;
	t=t>GredientConverter.maxTemperature?GredientConverter.maxTemperature:t;
	mark ("5","#aaa");
	mark ("3","#555");
	function mark(lineWidth,strokeStyle) {
		var y = margin + (height - margin*2) - (t / GredientConverter.maxTemperature * (height - margin*2) );
		var curve = margin/2;
		ctx.beginPath(); 
		ctx.lineWidth = lineWidth;
		ctx.strokeStyle = strokeStyle;
		ctx.moveTo(margin, y-margin);
		ctx.lineTo(width-margin, y-margin);
		ctx.quadraticCurveTo(width-curve, y-margin, width-curve, y-curve);
		ctx.lineTo(width-curve, y+curve);
		ctx.quadraticCurveTo(width-curve, y+margin, width-margin, y+margin);
		ctx.lineTo(margin, y+margin);
		ctx.quadraticCurveTo(curve, y+margin, curve, y+curve);
		ctx.lineTo(curve, y-curve);
		ctx.quadraticCurveTo(curve, y-margin, margin, y-margin);
		ctx.stroke();
	}
	$("<span>")
		.html(parseInt(t)+'¬∞')
		.appendTo("#temperature")
		.css({ 
	        'white-space' : 'nowrap',
	        'font-size' : '10px'
	    });

	} catch(e) { alert(e); }

} 


//
// Helpers
//

//
class GredientConverter {

	// üóí: array length should be % 10 = 1
	static colors = ["0800FF","0614FF","0429FF","023DFF",	//navi to blue
			"0051FF","0072FF","0093FF","00B5FF","00D6FF",	//blue to Turquoise 
			"00F7FF","00F7FF","00F7FF","00FBBB",	//Turquoise to spring green  
			"00FF77",/*"12FF5F",*/"24FF47","35FF30",/*"47FF18",*/	//Spring Green To green
			"59FF00","75F900","90F300","ACEE00","C7E800","E3E200","E3E200",	//Green to yellow
			"FEDC00","FEDC00","FCC201","FAA802","F78E02",	//yellow to orange
			"F57403","F75904","F93E06","FA2307",	//orange to red
			"FC0808","FC0840","FC0878","FC08B0","FC08B0",	//red to pink
			"FC08E8","D508EF","AD08F5","8608FC","8608FC","8608FC"];	//pink to purple 
 
	static maxTemperature = this.colors.length;

	static toTemperature(t) {
		return this.toColor(t,0,this.maxTemperature);
	}

	static toColor(n,from,to) {
		n=n<from?from:n;
		n=n>to?to:n;
		// find relative color in colors range
		var color = parseInt( (n-from) / (to-from) * (this.colors.length) );
		//$("#log").html(color+"<br>"+$("#log").html());
		return "#" + this.colors[color];
	} 
		
}


</script>

</head>

<body style="background:#000">

<div id="temperature" style="width:20px;height:200px;"></div>


<div id="log" style="_border:50px red;"></div>


<table>
	<tr></tr>
</table>

</body>
		
</html>